import{r as u,o as $,e as l,k as e,t as m,n as w,p as R,F as S,q as D,w as V,m as v,v as c,u as z,h as n}from"./vendor-wTwM5GbD.js";import{u as B}from"./index-CNyJ74Tt.js";import{u as M}from"./repository-CCfrAeA1.js";import{a as p}from"./mdui-B9C5XAKh.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"dashboard-layout"},q=["open"],F={class:"content-area"},L={class:"dashboard-header"},N={class:"stats-grid"},A={class:"stat-card"},E={class:"stat-value"},I={key:0,class:"repo-list"},O={class:"repo-info"},T=["onClick"],j={key:1,style:{padding:"32px","text-align":"center"}},G=["open"],H={__name:"Dashboard",setup(J){const x=z(),f=B(),b=M(),d=u(!1),a=u(!1),r=u([]),i=u({name:"",description:"",is_public:!1});async function g(){try{r.value=await b.fetchRepositories()}catch{p({message:"加载仓库失败",placement:"top"})}}async function y(){try{await b.createRepository(i.value),p({message:"仓库创建成功！",icon:"done",placement:"top"}),a.value=!1,i.value={name:"",description:"",is_public:!1},await g()}catch(s){p({message:s.error||"创建仓库失败",placement:"top"})}}function C(){f.logout(),p({message:"已退出登录",placement:"top"}),x.push("/")}return $(()=>{g()}),(s,t)=>{var k;return n(),l("div",h,[e("mdui-top-app-bar",null,[e("mdui-button-icon",{icon:"menu",onClick:t[0]||(t[0]=o=>d.value=!d.value)}),t[10]||(t[10]=e("mdui-top-app-bar-title",null,"仪表盘",-1)),t[11]||(t[11]=e("div",{style:{"flex-grow":"1"}},null,-1)),e("mdui-button-icon",{icon:"logout",onClick:C})]),e("mdui-navigation-drawer",{open:d.value,onClose:t[3]||(t[3]=o=>d.value=!1)},[e("mdui-list",null,[e("mdui-list-item",{icon:"dashboard",onClick:t[1]||(t[1]=o=>s.$router.push("/dashboard"))}," 仪表盘 "),e("mdui-list-item",{icon:"folder",onClick:t[2]||(t[2]=o=>s.$router.push("/repositories"))}," 我的仓库 "),t[12]||(t[12]=e("mdui-list-item",{icon:"settings"}," 设置 ",-1))])],40,q),e("div",F,[e("div",L,[e("h1",null,"欢迎, "+m((k=w(f).user)==null?void 0:k.username)+"!",1),e("mdui-button",{variant:"filled",icon:"add",onClick:t[4]||(t[4]=o=>a.value=!0)}," 创建仓库 ")]),e("div",N,[e("mdui-card",A,[t[13]||(t[13]=e("mdui-icon",{name:"folder",style:{"font-size":"48px",color:"var(--mdui-color-primary)"}},null,-1)),e("div",E,m(r.value.length),1),t[14]||(t[14]=e("div",{class:"stat-label"}," 仓库数量 ",-1))]),t[15]||(t[15]=R('<mdui-card class="stat-card" data-v-30204673><mdui-icon name="people" style="font-size:48px;color:var(--mdui-color-secondary);" data-v-30204673></mdui-icon><div class="stat-value" data-v-30204673> 0 </div><div class="stat-label" data-v-30204673> 协作者 </div></mdui-card><mdui-card class="stat-card" data-v-30204673><mdui-icon name="trending_up" style="font-size:48px;color:var(--mdui-color-tertiary);" data-v-30204673></mdui-icon><div class="stat-value" data-v-30204673> 0 </div><div class="stat-label" data-v-30204673> 活动 </div></mdui-card>',2))]),t[18]||(t[18]=e("h2",null,"最近的仓库",-1)),r.value.length>0?(n(),l("div",I,[(n(!0),l(S,null,D(r.value.slice(0,5),o=>(n(),l("mdui-card",{key:o.id,class:"repo-card"},[e("div",O,[t[16]||(t[16]=e("mdui-icon",{name:"folder"},null,-1)),e("div",null,[e("h3",null,m(o.name),1),e("p",null,m(o.description||"无描述"),1)])]),e("mdui-button",{variant:"text",onClick:K=>s.$router.push(`/repositories/${o.id}`)}," 查看详情 ",8,T)]))),128))])):(n(),l("mdui-card",j,[...t[17]||(t[17]=[e("p",null,"还没有仓库，创建第一个仓库吧！",-1)])]))]),e("mdui-dialog",{open:a.value,onClose:t[9]||(t[9]=o=>a.value=!1)},[t[19]||(t[19]=e("mdui-dialog-headline",null,"创建新仓库",-1)),e("mdui-dialog-body",null,[e("form",{onSubmit:V(y,["prevent"])},[v(e("mdui-text-field",{"onUpdate:modelValue":t[5]||(t[5]=o=>i.value.name=o),label:"仓库名称",required:""},null,512),[[c,i.value.name]]),v(e("mdui-text-field",{"onUpdate:modelValue":t[6]||(t[6]=o=>i.value.description=o),label:"描述",style:{"margin-top":"16px"}},null,512),[[c,i.value.description]]),v(e("mdui-checkbox",{"onUpdate:modelValue":t[7]||(t[7]=o=>i.value.is_public=o),style:{"margin-top":"16px"}}," 公开仓库 ",512),[[c,i.value.is_public]])],32)]),e("mdui-dialog-actions",null,[e("mdui-button",{onClick:t[8]||(t[8]=o=>a.value=!1)}," 取消 "),e("mdui-button",{variant:"filled",onClick:y}," 创建 ")])],40,G)])}}},Z=U(H,[["__scopeId","data-v-30204673"]]);export{Z as default};
