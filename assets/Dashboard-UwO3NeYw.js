import{r as u,o as $,e as l,k as t,t as m,n as w,p as R,F as S,q as D,w as V,m as v,v as c,u as z,h as n}from"./vendor-wTwM5GbD.js";import{u as B}from"./index-Cw8dJ5sJ.js";import{u as M}from"./repository-C335MaUT.js";import{a as p}from"./mdui-B9C5XAKh.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";const h={class:"dashboard-layout"},q=["open"],F={class:"content-area"},L={class:"dashboard-header"},N={class:"stats-grid"},A={class:"stat-card"},E={class:"stat-value"},I={key:0,class:"repo-list"},O={class:"repo-info"},T=["onClick"],j={key:1,style:{padding:"32px","text-align":"center"}},G=["open"],H={__name:"Dashboard",setup(J){const x=z(),f=B(),b=M(),d=u(!1),a=u(!1),r=u([]),i=u({name:"",description:"",is_public:!1});async function g(){try{r.value=await b.fetchRepositories()}catch{p({message:"加载仓库失败",placement:"top"})}}async function y(){try{await b.createRepository(i.value),p({message:"仓库创建成功！",icon:"done",placement:"top"}),a.value=!1,i.value={name:"",description:"",is_public:!1},await g()}catch(s){p({message:s.error||"创建仓库失败",placement:"top"})}}function C(){f.logout(),p({message:"已退出登录",placement:"top"}),x.push("/")}return $(()=>{g()}),(s,e)=>{var k;return n(),l("div",h,[t("mdui-top-app-bar",null,[t("mdui-button-icon",{icon:"menu",onClick:e[0]||(e[0]=o=>d.value=!d.value)}),e[10]||(e[10]=t("mdui-top-app-bar-title",null,"仪表盘",-1)),e[11]||(e[11]=t("div",{style:{"flex-grow":"1"}},null,-1)),t("mdui-button-icon",{icon:"logout",onClick:C})]),t("mdui-navigation-drawer",{open:d.value,onClose:e[3]||(e[3]=o=>d.value=!1)},[t("mdui-list",null,[t("mdui-list-item",{icon:"dashboard",onClick:e[1]||(e[1]=o=>s.$router.push("/dashboard"))}," 仪表盘 "),t("mdui-list-item",{icon:"folder",onClick:e[2]||(e[2]=o=>s.$router.push("/repositories"))}," 我的仓库 "),e[12]||(e[12]=t("mdui-list-item",{icon:"settings"}," 设置 ",-1))])],40,q),t("div",F,[t("div",L,[t("h1",null,"欢迎, "+m((k=w(f).user)==null?void 0:k.username)+"!",1),t("mdui-button",{variant:"filled",icon:"add",onClick:e[4]||(e[4]=o=>a.value=!0)}," 创建仓库 ")]),t("div",N,[t("mdui-card",A,[e[13]||(e[13]=t("mdui-icon",{name:"folder",style:{"font-size":"48px",color:"var(--mdui-color-primary)"}},null,-1)),t("div",E,m(r.value.length),1),e[14]||(e[14]=t("div",{class:"stat-label"},"仓库数量",-1))]),e[15]||(e[15]=R('<mdui-card class="stat-card" data-v-f0c5994e><mdui-icon name="people" style="font-size:48px;color:var(--mdui-color-secondary);" data-v-f0c5994e></mdui-icon><div class="stat-value" data-v-f0c5994e>0</div><div class="stat-label" data-v-f0c5994e>协作者</div></mdui-card><mdui-card class="stat-card" data-v-f0c5994e><mdui-icon name="trending_up" style="font-size:48px;color:var(--mdui-color-tertiary);" data-v-f0c5994e></mdui-icon><div class="stat-value" data-v-f0c5994e>0</div><div class="stat-label" data-v-f0c5994e>活动</div></mdui-card>',2))]),e[18]||(e[18]=t("h2",null,"最近的仓库",-1)),r.value.length>0?(n(),l("div",I,[(n(!0),l(S,null,D(r.value.slice(0,5),o=>(n(),l("mdui-card",{key:o.id,class:"repo-card"},[t("div",O,[e[16]||(e[16]=t("mdui-icon",{name:"folder"},null,-1)),t("div",null,[t("h3",null,m(o.name),1),t("p",null,m(o.description||"无描述"),1)])]),t("mdui-button",{variant:"text",onClick:K=>s.$router.push(`/repositories/${o.id}`)}," 查看详情 ",8,T)]))),128))])):(n(),l("mdui-card",j,[...e[17]||(e[17]=[t("p",null,"还没有仓库，创建第一个仓库吧！",-1)])]))]),t("mdui-dialog",{open:a.value,onClose:e[9]||(e[9]=o=>a.value=!1)},[e[19]||(e[19]=t("mdui-dialog-headline",null,"创建新仓库",-1)),t("mdui-dialog-body",null,[t("form",{onSubmit:V(y,["prevent"])},[v(t("mdui-text-field",{"onUpdate:modelValue":e[5]||(e[5]=o=>i.value.name=o),label:"仓库名称",required:""},null,512),[[c,i.value.name]]),v(t("mdui-text-field",{"onUpdate:modelValue":e[6]||(e[6]=o=>i.value.description=o),label:"描述",style:{"margin-top":"16px"}},null,512),[[c,i.value.description]]),v(t("mdui-checkbox",{"onUpdate:modelValue":e[7]||(e[7]=o=>i.value.is_public=o),style:{"margin-top":"16px"}}," 公开仓库 ",512),[[c,i.value.is_public]])],32)]),t("mdui-dialog-actions",null,[t("mdui-button",{onClick:e[8]||(e[8]=o=>a.value=!1)},"取消"),t("mdui-button",{variant:"filled",onClick:y},"创建")])],40,G)])}}},Z=U(H,[["__scopeId","data-v-f0c5994e"]]);export{Z as default};
